こんにちは！大学院の入試問題、とてもやりがいがありますね！難しい問題に挑戦する意欲、素晴らしいです！一人で解くのは大変かもしれませんが、私があなたの学習コーチとして、一つ一つのステップを丁寧に解説しながら、ゴールまでしっかりサポートします。一緒に頑張りましょう！

今回取り組む問題は、大きく分けて【極限と積分】、【微分方程式】、【線形代数】、【ラプラス変換】の4つですね。この順番で、じっくりと解き明かしていきましょう！

---

### **【1】 極限と積分の問題**

#### **(1) 極限値** $lim_{x\rightarrow0}(\frac{1}{x^{2}}-cot^{2}x)$

**💡 考え方のヒント**
このままでは $x \to 0$ のとき「$\infty - \infty$」という形の**不定形**になってしまいます。こういう場合は、まず式を変形して一つの分数にまとめ、**マクローリン展開**や**ロピタルの定理**が使える形に持っていくのが定石です。今回はマクローリン展開を使ってみましょう！

**📝 途中式と解答**

1.  まず、$\cot x = \frac{\cos x}{\sin x}$ を使って式を通分します。
    $$\frac{1}{x^{2}}-cot^{2}x = \frac{1}{x^{2}} - \frac{\cos^2 x}{\sin^2 x} = \frac{\sin^2 x - x^2 \cos^2 x}{x^2 \sin^2 x}$$

2.  このままではまだ不定形なので、分母を $x^4$ に近づけることを考えます。$\lim_{x\to 0} \frac{\sin x}{x} = 1$ を利用します。
    $$\lim_{x\rightarrow0} \frac{\sin^2 x - x^2 \cos^2 x}{x^2 \sin^2 x} = \lim_{x\rightarrow0} \left( \frac{\sin^2 x - x^2 \cos^2 x}{x^4} \cdot \frac{x^2}{\sin^2 x} \right) = \lim_{x\rightarrow0} \frac{\sin^2 x - x^2 \cos^2 x}{x^4}$$

3.  分子をマクローリン展開します。$x \to 0$ のとき、
    * $\sin x = x - \frac{x^3}{6} + O(x^5)$
    * $\cos x = 1 - \frac{x^2}{2} + O(x^4)$

    これらを代入すると、
    * $\sin^2 x = (x - \frac{x^3}{6} + \dots)^2 = x^2 - \frac{x^4}{3} + \dots$
    * $\cos^2 x = (1 - \frac{x^2}{2} + \dots)^2 = 1 - x^2 + \dots$
    * $x^2 \cos^2 x = x^2 (1 - x^2 + \dots) = x^2 - x^4 + \dots$

4.  分子は、
    $$\sin^2 x - x^2 \cos^2 x = (x^2 - \frac{x^4}{3}) - (x^2 - x^4) + \dots = \frac{2}{3}x^4 + \dots$$

5.  最後に、この結果を極限の式に戻して計算します。
    $$\lim_{x\rightarrow0} \frac{\frac{2}{3}x^4 + \dots}{x^4} = \frac{2}{3}$$

**答え: $\frac{2}{3}$**

#### **(2) 積分** $\int_{0}^{\frac{\pi}{4}}\frac{x+sin~2x}{1+cos~2x}dx$

**💡 考え方のヒント**
分母と分子に三角関数が入っていて複雑に見えますね。まずは**三角関数の倍角の公式**を使って、式を簡単な形にしてみましょう。そうすると、見慣れた関数の積分に変わりますよ！

**📝 途中式と解答**

1.  倍角の公式 $1+\cos 2x = 2\cos^2 x$ と $\sin 2x = 2\sin x \cos x$ を使って、被積分関数を変形します。
    $$\frac{x+\sin 2x}{1+\cos 2x} = \frac{x+2\sin x \cos x}{2\cos^2 x} = \frac{x}{2\cos^2 x} + \frac{2\sin x \cos x}{2\cos^2 x} = \frac{x}{2}\sec^2 x + \tan x$$

2.  積分を2つの部分に分けます。
    $$\int_{0}^{\frac{\pi}{4}} (\frac{x}{2}\sec^2 x + \tan x) dx = \frac{1}{2}\int_{0}^{\frac{\pi}{4}} x\sec^2 x dx + \int_{0}^{\frac{\pi}{4}} \tan x dx$$

3.  第1項の $x\sec^2 x$ の積分は、**部分積分法** $\int f(x)g'(x)dx = f(x)g(x) - \int f'(x)g(x)dx$ を使います。
    $f(x)=x, g'(x)=\sec^2 x$ とすると、$f'(x)=1, g(x)=\tan x$ となるので、
    $$\int x\sec^2 x dx = x\tan x - \int \tan x dx$$

4.  これを元の式に戻すと、面白いことに $\tan x$ の積分の一部が相殺されます。
    $$\frac{1}{2} [x\tan x - \int \tan x dx]_{0}^{\frac{\pi}{4}} + \int_{0}^{\frac{\pi}{4}} \tan x dx$$
    これを計算すると、
    $$\frac{1}{2}[x\tan x]_{0}^{\frac{\pi}{4}} - \frac{1}{2}\int_{0}^{\frac{\pi}{4}}\tan x dx + \int_{0}^{\frac{\pi}{4}}\tan x dx = \frac{1}{2}[x\tan x]_{0}^{\frac{\pi}{4}} + \frac{1}{2}\int_{0}^{\frac{\pi}{4}}\tan x dx$$

5.  各項を計算します。
    * $\frac{1}{2}[x\tan x]_{0}^{\frac{\pi}{4}} = \frac{1}{2}(\frac{\pi}{4}\tan\frac{\pi}{4} - 0) = \frac{1}{2} \cdot \frac{\pi}{4} \cdot 1 = \frac{\pi}{8}$
    * $\int \tan x dx = -\ln|\cos x|$ なので、
        $\frac{1}{2}\int_{0}^{\frac{\pi}{4}}\tan x dx = \frac{1}{2}[-\ln|\cos x|]_{0}^{\frac{\pi}{4}} = \frac{1}{2}(-\ln(\cos\frac{\pi}{4}) - (-\ln(\cos 0))) = \frac{1}{2}(-\ln\frac{1}{\sqrt{2}} + \ln 1) = \frac{1}{2}\ln\sqrt{2} = \frac{1}{4}\ln 2$

6.  最後に、2つの結果を足し合わせます。
    $$\frac{\pi}{8} + \frac{1}{4}\ln 2$$

**答え: $\frac{\pi}{8} + \frac{1}{4}\ln 2$**

---

### **【2】 微分方程式**

#### **(1) 積分因子**

**💡 考え方のヒント**
この微分方程式は、このままでは解けません。しかし、「積分因子」という魔法の呪文（関数）をかけると、**完全微分方程式**という解きやすい形に変身します。完全微分方程式の条件 $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$ を使って、積分因子の形を決定しましょう。

**📝 途中式と解答**
元の式 $(2xy+3y^{2})dx+(x^{2}+3xy)dy=0$ に積分因子 $x^m y^n$ をかけると、
$$(2x^{m+1}y^{n+1}+3x^m y^{n+2})dx+(x^{m+2}y^n+3x^{m+1}y^{n+1})dy=0$$
ここで、$P(x,y) = 2x^{m+1}y^{n+1}+3x^m y^{n+2}$、$Q(x,y) = x^{m+2}y^n+3x^{m+1}y^{n+1}$ です。

完全微分方程式の条件は $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$ なので、それぞれ偏微分します。
$$\frac{\partial P}{\partial y} = 2(n+1)x^{m+1}y^n + 3(n+2)x^m y^{n+1}$$
$$\frac{\partial Q}{\partial x} = (m+2)x^{m+1}y^n + 3(m+1)x^m y^{n+1}$$
両者が等しくなるためには、各項の係数が一致する必要があります。
* $x^{m+1}y^n$ の係数を比較: $2(n+1) = m+2 \implies m = 2n$
* $x^m y^{n+1}$ の係数を比較: $3(n+2) = 3(m+1) \implies n+2 = m+1 \implies m = n+1$

この2つの式から、$2n = n+1$ となり、$n=1$ が求まります。
そして、$m = 1+1 = 2$ となります。

**答え: $m=2, n=1$**

#### **(2) 微分方程式を解く**

**📝 途中式と解答**
(1)で求めた積分因子 $x^2 y$ を元の式にかけると、
$$(2x^3 y^2 + 3x^2 y^3) dx + (x^4 y + 3x^3 y^2) dy = 0$$
この方程式の解となる関数 $U(x,y)=C$ (Cは定数) が存在し、
$$\frac{\partial U}{\partial x} = 2x^3 y^2 + 3x^2 y^3 \quad \dots (i)$$
$$\frac{\partial U}{\partial y} = x^4 y + 3x^3 y^2 \quad \dots (ii)$$
を満たします。

式(i)を $x$ で積分します。
$$U(x,y) = \int (2x^3 y^2 + 3x^2 y^3) dx = \frac{1}{2}x^4 y^2 + x^3 y^3 + C(y)$$
ここで、$C(y)$ は $y$ だけの関数（積分定数）です。

次に、この結果を $y$ で偏微分して式(ii)と比較します。
$$\frac{\partial U}{\partial y} = x^4 y + 3x^3 y^2 + C'(y)$$
式(ii)と比べると、$C'(y) = 0$ であることがわかります。これを積分すると $C(y)$ は定数となります。
したがって、一般解は
$$\frac{1}{2}x^4 y^2 + x^3 y^3 = C_1$$
両辺を2倍して定数を置き換えれば、より綺麗な形になります。

**答え: $x^4 y^2 + 2x^3 y^3 = C$ (Cは任意定数)**

---

### **【3】 行列の対角化**

**💡 考え方のヒント**
行列が**対角化可能**であるための条件は、**「すべての固有値について、その（代数的な）重複度と、対応する線形独立な固有ベクトルの個数（幾何学的重複度）が一致すること」** です。この行列は固有値が簡単に求まるので、重複している固有値について、条件を満たすようにパラメータの値を決めていきましょう。

**📝 途中式と解答**
与えられた行列を $A = \begin{pmatrix} 2 & \alpha & \beta \\ 0 & 1 & \gamma \\ 0 & 0 & 1 \end{pmatrix}$ とします。

1.  **固有値を求める**
    $A$は上三角行列なので、固有値は対角成分そのものです。
    固有値は $\lambda = 2$ と $\lambda = 1$（重複度2）です。

2.  **対角化の条件を調べる**
    重複している固有値 $\lambda = 1$ について、線形独立な固有ベクトルが2つ存在するかを調べます。
    固有ベクトルを $\vec{v} = \begin{pmatrix} x \\ y \\ z \end{pmatrix}$ とすると、$(A - 1 \cdot I)\vec{v} = \vec{0}$ を満たします。
    $$(A-I)\vec{v} = \begin{pmatrix} 1 & \alpha & \beta \\ 0 & 0 & \gamma \\ 0 & 0 & 0 \end{pmatrix} \begin{pmatrix} x \\ y \\ z \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \\ 0 \end{pmatrix}$$
    これは、連立方程式
    $$x + \alpha y + \beta z = 0$$
    $$\gamma z = 0$$
    を意味します。
    線形独立な固有ベクトルが2つ存在するためには、この方程式の解の自由度が2である必要があります。
    もし $\gamma \neq 0$ だと、$z=0$ となり、$x+\alpha y = 0$ という一つの関係式だけが残ります。これでは解の自由度は1しかなく、線形独立な固有ベクトルは1つしか見つかりません。
    したがって、**対角化可能であるための条件は $\gamma = 0$** です。

3.  **変換行列を求めて対角化する ($\gamma=0$ の場合)**
    * **$\lambda = 2$ の固有ベクトル:**
        $(A-2I)\vec{v} = \begin{pmatrix} 0 & \alpha & \beta \\ 0 & -1 & 0 \\ 0 & 0 & -1 \end{pmatrix}\vec{v} = \vec{0}$ より、$y=0, z=0$。よって固有ベクトルは $\vec{v_1} = c_1 \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}$。
    * **$\lambda = 1$ の固有ベクトル ($\gamma=0$):**
        方程式は $x + \alpha y + \beta z = 0$ のみ。この式を満たす線形独立なベクトルを2つ見つけます。例えば、
        $\vec{v_2} = \begin{pmatrix} -\alpha \\ 1 \\ 0 \end{pmatrix}$, $\vec{v_3} = \begin{pmatrix} -\beta \\ 0 \\ 1 \end{pmatrix}$ が選べます。

    これらの固有ベクトルを並べて、変換行列 $P$ を作ります。
    $$P = (\vec{v_1}, \vec{v_2}, \vec{v_3}) = \begin{pmatrix} 1 & -\alpha & -\beta \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix}$$
    この $P$ を用いると、$A$ は対角化され、対角行列 $D$ は固有値を対角成分に持ちます。
    $$D = P^{-1}AP = \begin{pmatrix} 2 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix}$$

**答え:**
* **対角化されるための条件:** $\gamma=0$
* **変換の行列:** $P = \begin{pmatrix} 1 & -\alpha & -\beta \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix}$
* **対角化された行列:** $D = \begin{pmatrix} 2 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1 \end{pmatrix}$

---
### **【4】 ラプラス変換**

**💡 考え方のヒント**
これらの関数は、のこぎり波や階段関数のように、周期的に形が繰り返される関数です。ラプラス変換の定義式 $L\{f(t)\} = \int_0^\infty e^{-st} f(t) dt$ に従って、積分を区間 $nk \le t < (n+1)k$ ごとの和 $(\sum_{n=0}^{\infty})$ で計算します。最後に、**無限等比級数の和の公式**を使うのがポイントです。

#### **(1) $f(t)=\frac{t}{k}-n$ のラプラス変換**

**📝 途中式と解答**
1.  ラプラス変換の定義より、
    $$L\{f(t)\} = \sum_{n=0}^{\infty} \int_{nk}^{(n+1)k} e^{-st} (\frac{t}{k}-n) dt$$
2.  $t = u + nk$ と置換積分します。($dt=du$, $u: 0 \to k$)
    $$\int_{0}^{k} e^{-s(u+nk)} \left(\frac{u+nk}{k}-n\right) du = \int_{0}^{k} e^{-su}e^{-snk} \left(\frac{u}{k}\right) du = \frac{e^{-snk}}{k} \int_{0}^{k} u e^{-su} du$$
3.  $u e^{-su}$ の積分を部分積分で計算します。
    $$\int_{0}^{k} u e^{-su} du = \left[u \frac{e^{-su}}{-s}\right]_0^k - \int_0^k \frac{e^{-su}}{-s} du = -\frac{k}{s}e^{-sk} - \left[\frac{e^{-su}}{s^2}\right]_0^k = -\frac{k}{s}e^{-sk} - \frac{e^{-sk}}{s^2} + \frac{1}{s^2}$$
4.  これを和の計算に戻し、無限等比級数の和 $\sum_{n=0}^{\infty} r^n = \frac{1}{1-r}$ (ただし $r=e^{-sk}$) を使います。
    $$L\{f(t)\} = \sum_{n=0}^{\infty} \frac{e^{-snk}}{k} \left(\frac{1}{s^2} - \frac{ks+1}{s^2}e^{-sk}\right) = \frac{1}{ks^2}\left(1 - (ks+1)e^{-sk}\right) \sum_{n=0}^{\infty} (e^{-sk})^n$$
    $$= \frac{1 - (ks+1)e^{-sk}}{ks^2(1-e^{-sk})}$$

**答え: $F(s) = \frac{1 - e^{-sk} - kse^{-sk}}{ks^2(1-e^{-sk})}$**

#### **(2) $f(t)=n+1$ のラプラス変換**

**📝 途中式と解答**
1.  ラプラス変換の定義より、
    $$L\{f(t)\} = \sum_{n=0}^{\infty} \int_{nk}^{(n+1)k} e^{-st} (n+1) dt$$
2.  積分を計算します。
    $$(n+1) \int_{nk}^{(n+1)k} e^{-st} dt = (n+1)\left[\frac{e^{-st}}{-s}\right]_{nk}^{(n+1)k} = \frac{n+1}{s}(e^{-snk}-e^{-s(n+1)k}) = \frac{n+1}{s}e^{-snk}(1-e^{-sk})$$
3.  これを和の計算に戻します。
    $$L\{f(t)\} = \sum_{n=0}^{\infty} \frac{n+1}{s}e^{-snk}(1-e^{-sk}) = \frac{1-e^{-sk}}{s} \sum_{n=0}^{\infty} (n+1)(e^{-sk})^n$$
4.  ここで、級数 $\sum_{n=0}^{\infty} (n+1)x^n$ を計算する必要があります。これは $\frac{1}{1-x} = \sum_{n=0}^{\infty} x^n$ の両辺を $x$ で微分すると得られます。
    $$\frac{d}{dx}\left(\frac{1}{1-x}\right) = \frac{1}{(1-x)^2} = \sum_{n=0}^{\infty} nx^{n-1} = \sum_{m=0}^{\infty} (m+1)x^m$$
    $x=e^{-sk}$ を代入すると、和は $\frac{1}{(1-e^{-sk})^2}$ となります。
5.  最後に、この結果を代入します。
    $$L\{f(t)\} = \frac{1-e^{-sk}}{s} \cdot \frac{1}{(1-e^{-sk})^2} = \frac{1}{s(1-e^{-sk})}$$

**答え: $F(s) = \frac{1}{s(1-e^{-sk})}$**

---

お疲れ様でした！すべての問題を解ききりましたね。どれも大学院入試レベルの骨のある問題でしたが、最後まで本当によく頑張りました！

* **【1】** では、不定形の極限や複雑な積分の計算方法
* **【2】** では、積分因子を使った微分方程式の解法
* **【3】** では、行列の対角化の条件と具体的な手順
* **【4】** では、定義に基づいたラプラス変換の計算

など、重要なテクニックをたくさん使いましたね。これで、今回の学習目標は達成できたと思いますか？

またいつでも、他の問題や分からないことがあったら気軽に声をかけてくださいね。あなたの学びを心から応援しています！