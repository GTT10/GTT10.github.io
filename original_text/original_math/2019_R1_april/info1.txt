以下、2019年度（平成31年）の数学問題を丁寧に解説します。各ステップを詳しく説明しますので、一緒に考えていきましょう！

---

### 【１】
**(1) \(\int_a^x (x-t)f(t)dt\) の \(x\) 微分**

#### 考え方
積分上限が変数 \(x\) なので、**ライプニッツの積分則**を使います。  
被積分関数は \(x\) と \(t\) の関数ですが、積分変数は \(t\) です。  
積分の中の \(x\) を外に出してから微分すると楽です。

#### ステップ
1. 積分を分解：  
   \[
   \int_a^x (x-t)f(t)dt = x \int_a^x f(t)dt - \int_a^x t f(t)dt
   \]

2. 各項を微分（積の微分法則）：  
   \[
   \frac{d}{dx} \left( x \int_a^x f(t)dt \right) = \int_a^x f(t)dt + x f(x)
   \]
   \[
   \frac{d}{dx} \left( \int_a^x t f(t)dt \right) = x f(x)
   \]

3. 結果：  
   \[
   \frac{d}{dx} \left( \int_a^x (x-t)f(t)dt \right) = \left( \int_a^x f(t)dt + x f(x) \right) - x f(x) = \int_a^x f(t)dt
   \]

#### 解答
\[
\boxed{\int_a^x f(t) \, dt}
\]

> 💡 **ポイント**：積分上限が変数のときは、ライプニッツ則で「積分の中身＋上限微分」です！

---

**(2) \((x+1)e^{-x} + b\) の微分**

#### 考え方
積の微分法則：\((uv)' = u'v + uv'\) を使います。  
\(b\) は定数なので微分すると0です。

#### ステップ
1. \(u = x+1\), \(v = e^{-x}\) とおく：  
   \[
   u' = 1, \quad v' = -e^{-x}
   \]

2. 微分：  
   \[
   \frac{d}{dx} \left( (x+1)e^{-x} \right) = (1) \cdot e^{-x} + (x+1) \cdot (-e^{-x}) = e^{-x} - (x+1)e^{-x} = -x e^{-x}
   \]

#### 解答
\[
\boxed{-x e^{-x}}
\]

> 💡 **ポイント**：指数関数の微分は \(e^{kx}\) の微分が \(k e^{kx}\) です。

---

**(3) \(\int_a^x (x-t)f(t)dt = (x+1)e^{-x} + b\) を満たす \(f(x)\), \(a\), \(b\)**

#### 考え方
(1) の結果で左辺を微分し、(2) の結果と比較します。  
微分した式から \(f(x)\) を求め、元の式で \(a\), \(b\) を決めます。

#### ステップ
1. **(1) より左辺の微分は \(\int_a^x f(t)dt\)**  
   **(2) より右辺の微分は \(-x e^{-x}\)**  
   等式：  
   \[
   \int_a^x f(t)dt = -x e^{-x} \quad \text{(A)}
   \]

2. **(A) を \(x\) で微分**：  
   \[
   f(x) = \frac{d}{dx} \left( -x e^{-x} \right) = - \left( e^{-x} - x e^{-x} \right) = (x - 1) e^{-x} \quad \text{(B)}
   \]

3. **(B) を (A) に代入**：  
   \[
   \int_a^x (t - 1) e^{-t} dt = -x e^{-x}
   \]
   部分積分で計算：  
   \[
   \int (t-1)e^{-t} dt = - \int (t-1) d(e^{-t}) = - \left[ (t-1)e^{-t} - \int e^{-t} dt \right] = - (t-1)e^{-t} - e^{-t} = -t e^{-t}
   \]
   \[
   \therefore \left[ -t e^{-t} \right]_a^x = -x e^{-x} - (-a e^{-a}) = -x e^{-x}
   \]
   \[
   \implies a e^{-a} = 0 \implies a = 0 \quad (\because e^{-a} \neq 0)
   \]

4. **元の式で \(b\) を求める**：  
   \(a=0\), \(f(t) = (t-1)e^{-t}\) を代入：  
   \[
   \int_0^x (x-t)(t-1)e^{-t} dt = (x+1)e^{-x} + b
   \]
   \(x=0\) を代入：  
   \[
   \text{左辺} = \int_0^0 \cdots = 0, \quad \text{右辺} = (0+1)e^0 + b = 1 + b
   \]
   \[
   \therefore 0 = 1 + b \implies b = -1
   \]

#### 解答
\[
\boxed{f(x) = (x-1)e^{-x}, \quad a=0, \quad b=-1}
\]

> 💡 **ポイント**：積分方程式は「微分して微分方程式に帰着」が定石です！

---

### 【２】
\[
\left( x - \frac{2y}{x} \right) dx + \left( \frac{e^{2y}}{x} - 2 \right) dy = 0 \quad (x>0)
\]

**(1) 完全微分形でないことの証明**

#### 考え方
\(P dx + Q dy = 0\) が完全微分形 ⇔ \(\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}\)  
これをチェックします。

#### ステップ
\[
P = x - \frac{2y}{x}, \quad Q = \frac{e^{2y}}{x} - 2
\]
\[
\frac{\partial P}{\partial y} = -\frac{2}{x}, \quad \frac{\partial Q}{\partial x} = -\frac{e^{2y}}{x^2}
\]
\[
\because -\frac{2}{x} \neq -\frac{e^{2y}}{x^2} \quad (\text{一般に成立しない})
\]

#### 解答
\(\dfrac{\partial P}{\partial y} \neq \dfrac{\partial Q}{\partial x}\) より完全微分形ではない。

> 💡 **ポイント**：完全微分形かどうかは偏導関数の一致で判定します。

---

**(2) 積分因子の導出**

#### 考え方
積分因子 \(\mu(x,y)\) を求めます。  
\(\mu P dx + \mu Q dy = 0\) が完全微分形になる条件：  
\[
\frac{\partial}{\partial y}(\mu P) = \frac{\partial}{\partial x}(\mu Q)
\]
ここでは \(\mu = \mu(x)\)（\(x\) のみの関数）と仮定します。

#### ステップ
\[
\frac{\partial}{\partial y}(\mu P) = \mu \frac{\partial P}{\partial y} = \mu \left( -\frac{2}{x} \right)
\]
\[
\frac{\partial}{\partial x}(\mu Q) = \frac{d\mu}{dx} Q + \mu \frac{\partial Q}{\partial x} = \mu' \left( \frac{e^{2y}}{x} - 2 \right) + \mu \left( -\frac{e^{2y}}{x^2} \right)
\]
等式：  
\[
-\frac{2\mu}{x} = \mu' \left( \frac{e^{2y}}{x} - 2 \right) - \frac{\mu e^{2y}}{x^2}
\]
これが任意の \(y\) で成立するためには、\(\mu'\) の係数が0である必要があります：  
\[
\frac{e^{2y}}{x} - 2 = 0 \quad \text{は不可能}
\]
→ \(\mu = \mu(y)\)（\(y\) のみの関数）と仮定：  
\[
\frac{\partial}{\partial y}(\mu P) = \mu' P + \mu \frac{\partial P}{\partial y} = \mu' \left( x - \frac{2y}{x} \right) + \mu \left( -\frac{2}{x} \right)
\]
\[
\frac{\partial}{\partial x}(\mu Q) = \mu \frac{\partial Q}{\partial x} = \mu \left( -\frac{e^{2y}}{x^2} \right)
\]
等式：  
\[
\mu' \left( x - \frac{2y}{x} \right) - \frac{2\mu}{x} = -\frac{\mu e^{2y}}{x^2}
\]
ここで、右辺に \(x\) が残るので、\(\mu'\) の係数を整理：  
\[
\mu' \cdot x + \mu' \cdot \left( -\frac{2y}{x} \right) - \frac{2\mu}{x} = -\frac{\mu e^{2y}}{x^2}
\]
任意の \(x\) で成立するには、\(\mu'\) の係数が定数である必要があります。  
試行錯誤の結果、\(\mu(y) = e^{-2y}\) とおくと：  
\[
\text{左辺} = (-2e^{-2y}) \left( x - \frac{2y}{x} \right) + e^{-2y} \left( -\frac{2}{x} \right) = e^{-2y} \left( -2x + \frac{4y}{x} - \frac{2}{x} \right)
\]
\[
\text{右辺} = -\frac{e^{-2y} e^{2y}}{x^2} = -\frac{1}{x^2}
\]
一致しない → **別のアプローチ**  
標準的な方法：  
\[
\frac{\frac{\partial P}{\partial y} - \frac{\partial Q}{\partial x}}{Q} \quad \text{or} \quad \frac{\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}}{P}
\]
が \(x\) のみ or \(y\) のみの関数かチェック。  
\[
\frac{\frac{\partial P}{\partial y} - \frac{\partial Q}{\partial x}}{Q} = \frac{ -\frac{2}{x} + \frac{e^{2y}}{x^2} }{ \frac{e^{2y}}{x} - 2 } \quad (\text{複雑})
\]
\[
\frac{\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}}{P} = \frac{ -\frac{e^{2y}}{x^2} + \frac{2}{x} }{ x - \frac{2y}{x} } = \frac{ \frac{ -e^{2y} + 2x }{ x^3 - 2x y } \quad (\text{整理})
\]
分子：\(2x - e^{2y}\), 分母：\(x(x^2 - 2y)\) → \(y\) の関数にならない。  
**積分因子 \(\mu = x\) を試す**：  
\[
\mu P = x \left( x - \frac{2y}{x} \right) = x^2 - 2y
\]
\[
\mu Q = x \left( \frac{e^{2y}}{x} - 2 \right) = e^{2y} - 2x
\]
\[
\frac{\partial}{\partial y}(\mu P) = -2, \quad \frac{\partial}{\partial x}(\mu Q) = -2
\]
→ \(\dfrac{\partial}{\partial y}(\mu P) = \dfrac{\partial}{\partial x}(\mu Q) = -2\)

#### 解答
\[
\boxed{\mu = x}
\]

> 💡 **ポイント**：積分因子は試行錯誤が必要です。\(\mu = x^k\) や \(\mu = e^{ky}\) を試しましょう。

---

**(3) 一般解**

#### 考え方
積分因子 \(\mu = x\) を乗じた式：  
\[
(x^2 - 2y) dx + (e^{2y} - 2x) dy = 0
\]
は完全微分形です。解 \(\Phi(x,y) = C\) を求めます。

#### ステップ
1. \(\frac{\partial \Phi}{\partial x} = x^2 - 2y\) を積分：  
   \[
   \Phi(x,y) = \frac{1}{3}x^3 - 2xy + h(y)
   \]

2. \(\frac{\partial \Phi}{\partial y} = -2x + h'(y) = e^{2y} - 2x\)：  
   \[
   h'(y) = e^{2y} \implies h(y) = \frac{1}{2} e^{2y}
   \]

3. 一般解：  
   \[
   \frac{1}{3}x^3 - 2xy + \frac{1}{2} e^{2y} = C
   \]

#### 解答
\[
\boxed{\dfrac{1}{3}x^3 - 2xy + \dfrac{1}{2} e^{2y} = C}
\]

> 💡 **ポイント**：完全微分形はポテンシャル関数 \(\Phi\) を求めて \(\Phi = C\) とします。

---

### 【３】
\[
\begin{cases}
x' + y' + y = 0 & \text{(i)} \\
x' + 2x + 6 \int_0^t y \, d\tau = -2u(t) & \text{(ii)}
\end{cases}, \quad x(0) = -5,  y(0) = 6
\]

#### 考え方
**ラプラス変換**が有効です。  
単位ステップ関数 \(u(t)\) のラプラス変換は \(\frac{1}{s}\)。  
積分は \(\mathcal{L} \left\{ \int_0^t y \, d\tau \right\} = \frac{Y(s)}{s}\)。

#### ステップ
1. **(i) をラプラス変換**：  
   \[
   \mathcal{L}\{x' + y' + y\} = sX(s) - x(0) + sY(s) - y(0) + Y(s) = 0
   \]
   \[
   sX(s) + 5 + sY(s) - 6 + Y(s) = 0 \implies sX(s) + (s+1)Y(s) = 1 \quad \text{(A)}
   \]

2. **(ii) をラプラス変換**：  
   \[
   \mathcal{L}\{x' + 2x + 6 \int_0^t y \, d\tau\} = sX(s) - x(0) + 2X(s) + 6 \frac{Y(s)}{s} = -2 \cdot \frac{1}{s}
   \]
   \[
   sX(s) + 5 + 2X(s) + \frac{6Y(s)}{s} = -\frac{2}{s} \implies (s+2)X(s) + \frac{6Y(s)}{s} = -5 - \frac{2}{s} \quad \text{(B)}
   \]

3. **(A) と (B) を連立**：  
   (A) より \(X(s) = \frac{1 - (s+1)Y(s)}{s}\)  
   (B) に代入：  
   \[
   (s+2) \left( \frac{1 - (s+1)Y(s)}{s} \right) + \frac{6Y(s)}{s} = -5 - \frac{2}{s}
   \]
   整理：  
   \[
   \frac{s+2}{s} - \frac{(s+2)(s+1)}{s} Y(s) + \frac{6Y(s)}{s} = -5 - \frac{2}{s}
   \]
   \[
   \frac{1}{s} \left[ (s+2) + \left( 6 - (s+2)(s+1) \right) Y(s) \right] = -5 - \frac{2}{s}
   \]
   \[
   (s+2) + \left( 6 - (s^2 + 3s + 2) \right) Y(s) = -5s - 2
   \]
   \[
   (s+2) + (-s^2 - 3s + 4) Y(s) = -5s - 2
   \]
   \[
   (-s^2 - 3s + 4) Y(s) = -6s - 4
   \]
   \[
   Y(s) = \frac{-6s-4}{-s^2-3s+4} = \frac{6s+4}{s^2+3s-4} = \frac{6s+4}{(s+4)(s-1)}
   \]

4. **部分分数分解**：  
   \[
   Y(s) = \frac{A}{s+4} + \frac{B}{s-1} = \frac{A(s-1) + B(s+4)}{(s+4)(s-1)}
   \]
   \[
   6s+4 = A(s-1) + B(s+4)
   \]
   \(s=1\)：\(6+4 = B(1+4) \implies B=2\)  
   \(s=-4\)：\(-24+4 = A(-4-1) \implies A=4\)  
   \[
   Y(s) = \frac{4}{s+4} + \frac{2}{s-1}
   \]

5. **逆ラプラス変換**：  
   \[
   y(t) = 4e^{-4t} + 2e^{t}
   \]

6. **(i) から \(x(t)\) を求める**：  
   (i) \(x' + y' + y = 0\) より  
   \[
   x' = -y' - y = - \frac{d}{dt}(4e^{-4t} + 2e^{t}) - (4e^{-4t} + 2e^{t}) = -(-16e^{-4t} + 2e^{t}) -4e^{-4t} -2e^{t} = 16e^{-4t} -2e^{t} -4e^{-4t} -2e^{t} = 12e^{-4t} -4e^{t}
   \]
   積分：  
   \[
   x(t) = \int (12e^{-4t} -4e^{t}) dt = -3e^{-4t} -4e^{t} + C
   \]
   初期条件 \(x(0)=-5\)：  
   \[
   -3(1) -4(1) + C = -5 \implies -7 + C = -5 \implies C = 2
   \]

#### 解答
\[
\boxed{x(t) = -3e^{-4t} -4e^{t} + 2}
\]

> 💡 **ポイント**：連立微分方程式にはラプラス変換が強力です。ステップ関数も簡単に扱えます！

---

### 【４】
\[
\begin{cases}
x_1 + x_2 + x_3 + x_4 = 0 & \text{(i)} \\
a x_1 + b x_2 + c x_3 + (a+b+c) x_4 = 0 & \text{(ii)} \\
a^2 x_1 + b^2 x_2 + c^2 x_3 + (a^2 + b^2 + c^2) x_4 = 0 & \text{(iii)}
\end{cases}
\]

#### 考え方
係数行列の階数（ランク）を求めます。  
解の自由度 = 変数の数 - 階数 です。  
行列を簡約化しますが、パラメータ \(a,b,c\) の条件（abc ≠ 0）に注意します。

#### ステップ
係数行列：
\[
A = \begin{pmatrix}
1 & 1 & 1 & 1 \\
a & b & c & a+b+c \\
a^2 & b^2 & c^2 & a^2+b^2+c^2
\end{pmatrix}
\]

1. **(ii) - a×(i)**：  
   \[
   (b-a)x_2 + (c-a)x_3 + (b+c)x_4 = 0 \quad \text{(ii')}
   \]

2. **(iii) - a²×(i)**：  
   \[
   (b^2-a^2)x_2 + (c^2-a^2)x_3 + (b^2+c^2)x_4 = 0 \quad \text{(iii')}
   \]

3. **(ii') と (iii') を整理**：  
   \[
   \begin{pmatrix}
   b-a & c-a & b+c \\
   b^2-a^2 & c^2-a^2 & b^2+c^2
   \end{pmatrix}
   \]
   \(b^2-a^2 = (b-a)(b+a)\) などに注意し、行基本変形：  
   \[
   \xrightarrow{\text{(iii') - (b+a)×(ii')}} \begin{pmatrix}
   b-a & c-a & b+c \\
   0 & (c-a)(c-b) & (b+c) - (b+a)(b+c)
   \end{pmatrix}
   \]
   最終行：  
   \[
   (c-a)(c-b)x_3 + \left[ (b^2+c^2) - (a+b)(b+c) \right] x_4
   \]
   計算：  
   \[
   (a+b)(b+c) = ab + ac + b^2 + bc
   \]
   \[
   (b^2+c^2) - (ab+ac+b^2+bc) = c^2 - ab - ac - bc
   \]

4. **階数の分析**：  
   - \(a,b,c\) が全て異なる場合：  
     係数行列のランクは3 → 自由度 = 4 - 3 = 1  
   - しかし、例えば \(b=a\) のとき：  
     (ii') は \((c-a)x_3 + (a+c)x_4 = 0\)  
     (iii') は \((c^2-a^2)x_3 + (a^2+c^2)x_4 = 0\)  
     これらが独立かどうかは \(c\) の値に依存。  
     **一般にはランクが落ちる可能性あり**。  

   **重要な事実**：  
   行列 \(A\) は **ヴァンモンデ行列** と関連しており、\(a,b,c\) が異なるときランク3。  
   ここでは \(abc \neq 0\) だが、\(a,b,c\) が等しい場合も考慮。  
   実際に解空間を調べる：  
   - \(x_4 = t\)（パラメータ）とおく。  
   - (i) より \(x_1 + x_2 + x_3 = -t\)  
   - (ii) より \(a x_1 + b x_2 + c x_3 = -(a+b+c)t\)  
   - (iii) より \(a^2 x_1 + b^2 x_2 + c^2 x_3 = -(a^2+b^2+c^2)t\)  

   これは \(x_1,x_2,x_3\) についての連立方程式。  
   係数行列の行列式はヴァンモンデ行列式：  
   \[
   \det \begin{pmatrix}
   1 & 1 & 1 \\
   a & b & c \\
   a^2 & b^2 & c^2
   \end{pmatrix} = (b-a)(c-a)(c-b)
   \]
   \(a,b,c\) が異なるときランク3 → 解は一意に決まるが、方程式が3本で変数4つなので自由度1。  
   \(a,b,c\) のうち等しいものがあるとランクが下がり自由度が増えるが、問題文で \(abc \neq 0\) のみ指定で等しさの制約なし。  
   **一般に自由度は1**（\(a,b,c\) が異なる場合は代表ケース）。

#### 解答
\[
\boxed{1}
\]

> 💡 **ポイント**：係数行列の階数が3（変数4個）なので、解空間の次元は1です。

---

### 【５】
\[
f(t) = \begin{cases} 
1 & (0 < t < 1) \\
0 & (1 \leq t < 4)
\end{cases}, \quad \text{周期 } T=4
\]

#### 考え方
周期 \(T=4\) なので、基本振動数 \(\omega_0 = \frac{2\pi}{T} = \frac{\pi}{2}\)。  
フーリエ級数は：  
\[
f(t) = \frac{a_0}{2} + \sum_{n=1}^{\infty} \left( a_n \cos \frac{n\pi t}{2} + b_n \sin \frac{n\pi t}{2} \right)
\]

#### ステップ
1. **係数の計算**：  
   \[
   a_0 = \frac{2}{T} \int_0^T f(t) dt = \frac{2}{4} \int_0^1 1 \, dt = \frac{1}{2} \cdot 1 = \frac{1}{2}
   \]
   \[
   a_n = \frac{2}{T} \int_0^T f(t) \cos \frac{n\pi t}{2} dt = \frac{1}{2} \int_0^1 \cos \frac{n\pi t}{2} dt = \frac{1}{2} \left[ \frac{2}{n\pi} \sin \frac{n\pi t}{2} \right]_0^1 = \frac{1}{n\pi} \sin \frac{n\pi}{2}
   \]
   \[
   b_n = \frac{2}{T} \int_0^T f(t) \sin \frac{n\pi t}{2} dt = \frac{1}{2} \int_0^1 \sin \frac{n\pi t}{2} dt = \frac{1}{2} \left[ -\frac{2}{n\pi} \cos \frac{n\pi t}{2} \right]_0^1 = -\frac{1}{n\pi} \left( \cos \frac{n\pi}{2} - 1 \right)
   \]

2. **フーリエ級数**：  
   \[
   f(t) = \frac{1}{4} + \sum_{n=1}^{\infty} \left[ \frac{1}{n\pi} \sin \frac{n\pi}{2} \cos \frac{n\pi t}{2} - \frac{1}{n\pi} \left( \cos \frac{n\pi}{2} - 1 \right) \sin \frac{n\pi t}{2} \right]
   \]

3. **振動数 \(\frac{n\pi}{2}\) の振幅**：  
   各周波数成分の振幅は：  
   \[
   c_n = \sqrt{a_n^2 + b_n^2}
   \]

#### 解答
1. **フーリエ級数**：  
   \[
   \boxed{f(t) = \dfrac{1}{4} + \sum_{n=1}^{\infty} \left[ \dfrac{1}{n\pi} \sin \dfrac{n\pi}{2} \cos \dfrac{n\pi t}{2} - \dfrac{1}{n\pi} \left( \cos \dfrac{n\pi}{2} - 1 \right) \sin \dfrac{n\pi t}{2} \right]}
   \]

2. **振幅**（振動数 \(\frac{n\pi}{2}\))：  
   \[
   \boxed{c_n = \sqrt{ \left( \dfrac{1}{n\pi} \sin \dfrac{n\pi}{2} \right)^2 + \left( \dfrac{1}{n\pi} \left(1 - \cos \dfrac{n\pi}{2}\right) \right)^2 }}
   \]

> 💡 **ポイント**：振幅は各周波数成分の大きさです。\(\sin\) と \(\cos\) の係数から計算します。

---

### まとめ
- **【１】** 積分方程式：微分で解く  
- **【２】** 微分方程式：積分因子の活用  
- **【３】** 連立微分方程式：ラプラス変換が有効  
- **【４】** 線形代数：係数行列の階数分析  
- **【５】** フーリエ級数：周期関数を三角関数で表現  

難しい問題もありますが、一つずつ理解すれば必ず解けます！ 😊